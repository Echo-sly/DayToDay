## 1. Mysql的扩展性瓶颈

MySQL数据库也经常存储一些大文本的字段，导致数据库表非常的大，在做数据库恢复的时候就导致非 常的慢，不容易快速恢复数据库，比如1000万4KB大小的文本就接近40GB的大小，如果能把这些数据 从MySQL省去，MySQL将变的非常的小，关系数据库很强大，但是它并不能很好的应付所有的应用场景，MySQL的扩展性差（需要复杂的技术来实现），大数据下IO压力大，表结构更改困难，正是当前使用MySQL的开发人员面临的问题。

## 2.什么是NoSQL

NoSQL = Not Only SQL  意思是：不仅仅是SQL

泛指非关系型数据库，随着互联网Web2.0网站的兴起，传统的关系数据库在应付web2.0网站，特别 是超大规模和高并发的社交网络服务类型的Web2.0纯动态网站已经显得力不从心，暴露了很多难以克服 的问题，而非关系型的数据库则由于其本身的特点得到了非常迅速的发展，NoSQL数据库的产生就是为 了解决大规模数据集合多种数据种类带来的挑战，尤其是大数据应用难题，包括超大规模数据的存储。

## 3.NoSQL的特点

- 易扩展

NoSQL数据库种类繁多，但是一个共同的特点都是去掉关系数据库的关系型特性。

数据之间无关系，这样就非常容易扩展，也无形之间，在架构的层面上带来了可扩展的能力。

- 大数据高性能

NoSQL数据库都具有非常高的读写性能，尤其是在大数据量下，同样表现优秀。这得益于他的非关系性，数据库结构简单。

一般MySQL使用Query Cache,每次表的更新Cache就失效，是一种大力度的Cache,在针对Web2.0的交互频繁应用，Cache性能不高，而NoSQL的Cache是记录级的，是一种细粒度的Cache，所以NoSQl性能高的很多。

- 多样灵活的数据模型

NoSQL无需事先为要存储的数据建立字段，随时可以存储自定义的数据格式，而在关系数据库里，增删字段是一件非常麻烦的事情。如果是非常大数据量的表，增加字段简直是噩梦。

## 4.3V+3高

大数据时代的3V：主要是对问题的描述

- 海量 Volume
- 多样 Variety
- 实时 Velocity

互联网需求的三高：主要是对程序的要求

- 高并发
- 高可用
- 高性能

## 5.NoSQL四大分类

KV键值：

- 新浪：BerkeleyDB+redis

- 美团：redis+tair

- 阿里、百度：memcache+redis

文档型数据库(bson格式比较多)：

- CouchDB
- MongoDB
  - MongoDB是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。
  - MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富的，是最像关系数据库的。

列存储数据库：

- Cassandra，HBase
- 分布式文件系统

图关系数据库

- 他不是放图形的，放的是关系比如：朋友圈社交网络、广告推荐系统。
- 社交网络，推荐系统等。专注于构建关系图谱。
- Neo4J，InfoGrid

![image-20210912184334785](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210912184334785.png)



## 6.传统的ACID：

关系型数据库遵循ACID规则，事务在英文中是transaction,和现实时间中的交易很类似，他有如下四个特性：

- A（Atomicity）原子性

```
原子性很容易理解，也就是说事务里的所有操作要么全部做完，要么都不做，事务成功的条件是事务里的所有操作都成功，只要有一个操作失败，整个事务就失败，需要回滚。
```

- C（Consistency）一致性

```
事务前后数据的完整性必须保持一致
```

- I（Isolation）隔离性

```
所谓的隔离性是指并发之间不会互相影星，如果一个事务要访问的数据正在被另外一个事务修改，只要另外一个事务未提交，他所访问的数据就不不受未提交事务的影响。比如现有个交易是从A账户转100元到B账户，在这个交易还未完成的情况下，如果此时B查询自己的账户，是看不到新增加的100元的。
```

- D（Durability）持久性

```
持久性是指一旦事务提交后，他所做的修改将会永久的保存在数据库上
```

## 7.CAP理论

- C：Consistency（强一致性）
- A：Availability（可用性）
- P：Partition tolerance（分区容错性）

CAP理论就是说在分布式存储系统中，最多只能实现上面的两点

而由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容错性是我们必须要实现的。

所以我们只能在一致性和可用性之间进行权衡，没有NoSQL系统能同时保证这三点。

注意：分布式架构的时候必须做出取舍

一致性和可用性之间取一个平衡。大多数WEB应用，其实并不需要强一致性。

因此牺牲C换取P，这是目前分布式数据库的方向。

**一致性与可用性的抉择**

对于大部分WEB网站来说，关系型数据库的很多主要特性却无用武之地

**数据库事务一致性需求**

很多web实时系统并不要求严格的数据库事务，对读一致性的要求很低，有些场合对写一致性要求并不高。允许实现最终一致性。

**数据库的写实时性和读一致性**

对关系数据库来说，插入一条数据之后立刻查询，是肯定可以读出来这条数据的，但是对于很多web应用来说，并不要求这么高的实时性，比方说发一条消息之后，过几秒乃至十几秒之后，我的订阅者才看到这条动态是完全可以接受的。

**对复杂的SQL查询，特别是多表关联查询的需求**

任何大数据量的WEB系统，都非常忌讳多个大表的关联查询，以及复杂的数据分析类型的报表查询，特表示SNS类型的网站，从需求以及产品设计角度，就避免了这种情况的产生。往往更多的甚至是单表的主键查询，以及单表的简单条件分页查询，SQL的功能被极大的弱化了

**CAP理论的核心：**一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个。因此，根据CAP原理将NoSQL数据库分成了满足CA原则、满足CP原则和满足AP原则三大类：

CA -单点集群，满足一致性，可用户性的系统，通常在可扩展性上不太强大。

CP -满足一致性，分区容忍性的系统，通常性能不是特别高。

AP -满足可用性，分区容忍性的系统，通常可能对一致性要求低一些

![image-20210912193659810](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210912193659810.png)

## 8.BASE 理论

BASE理论是由eBay架构师提出的，BASE是对CAP中一致性和可用性权衡的结果，其来源对于大规模互联网分布式系统实践的总结，是基于CAP定律逐步演化而来。其核心思想是即使无法做到强一致性，但每个应用都可以根据自身业务特点，采用适当的方式来使系统用达到最终一致性。

**BASE就是为了解决关系数据库强一致性引起的问题而引起的可用性降低而提出的解决方案。**

BASE其实是下面三个术语的缩写：

- 基本可用（Basically Available）：基本可用是指分布式系统在出现故障的时候，允许损失部分可用性，即保证核心可用。电商大促时，为了应对访问量激增，部分用户可能会被引导到降级页面，服务层也可能只提供奖及服务。这就是损失可用性的体现。
- 软状态（Soft State）：软状态是指允许系统存在中间状态，而该中间状态不会影响系统整体可用性。分布式存储中一般一份数据至少会有三个副本，允许不同节点间副本同步的延时就是软状态体现。MySQL Replication 的异步复制也是一种体现。
- 最终一致性（Eventual Consistency）：最终一致性是指系统中的所有数据副本经过一定时间后，最终能够达到一致的转台。弱一致性和强一致性相反，最终一致性是弱一致性的一种特殊情况。

他的事项是通过让系统放松对某一时刻数据一致性的要求来换取系统整体伸缩性和性能上改观，为什么这么说呢，缘由就在于大型系统往往由于地域分布和极高性能的要求，不可能采用分布式事务来完成这些指标，要想获得这些指标，我们必须采用另外一种方式来完成，这里BASE就是解决这个问题的办法：

**解释：**

1.分布式：不同的堕胎服务器上面部署不同的服务模块（工程），他们之间通过RPC通信和调用，对外提供服务和组内协作。

2.集群：不同的堕胎服务器上面部署相同的服务模块，通过分布式调度软件进行统一的调度，对外提供服务和访问。

**理解：**

拿饭店后厨来打比方：

分布式就是将一个厨师所做的工作分别派发给：面案、切墩、西点、烧菜师傅......

集群就是多个厨师做不同的菜。

